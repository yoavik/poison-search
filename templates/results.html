{% extends "base.html" %}
{% block content %}
<h2 class="page-title">转爪转 驻砖</h2>
<div class="card elevate">
  <div class="row" style="align-items:center">
    <div>
      <div><strong>砖转:</strong> <code>{{ query }}</code></div>
      <div class="small muted">
        爪: {{ mode }} | 转爪转 拽住转: {{ max_results }} | ' 拽: {{ min_likes }}
        {% if since_date %}| 转专: {{ since_date }}{% endif %}
        {% if until_date %}| 注 转专: {{ until_date }}{% endif %}
      </div>
    </div>
    <div class="actions" style="margin-left:auto">
      <form method="post" action="/export" style="display:inline">
        <input type="hidden" name="phrase" value="{{ phrase }}">
        <input type="hidden" name="mode" value="{{ mode }}">
        <input type="hidden" name="max_results" value="{{ max_results }}">
        <input type="hidden" name="min_likes" value="{{ min_likes }}">
        {% for a in authors %}<input type="hidden" name="authors" value="{{ a }}">{% endfor %}
        <button type="submit">猬锔 爪 CSV</button>
      </form>
      <form method="post" action="/export_xlsx" style="display:inline">
        <input type="hidden" name="phrase" value="{{ phrase }}">
        <input type="hidden" name="mode" value="{{ mode }}">
        <input type="hidden" name="max_results" value="{{ max_results }}">
        <input type="hidden" name="min_likes" value="{{ min_likes }}">
        {% for a in authors %}<input type="hidden" name="authors" value="{{ a }}">{% endfor %}
        <button type="submit" class="primary">猬锔 爪 Excel / Sheets</button>
      </form>
    </div>
  </div>
</div>

<p class="small muted">爪 {{ count }} 爪爪.</p>
{% if authors and authors|length > 0 %}
<p class="small muted"><strong>砖转砖 住:</strong> {% for a in authors %}<code>@{{ a }}</code>{% if not loop.last %}, {% endif %}{% endfor %}</p>
{% endif %}

<table class="list elevate">
  <thead>
    <tr>
      <th></th>
      <th>砖转砖</th>
      <th>拽住</th>
      <th>わ</th>
      <th></th>
      <th></th>
      <th>爪驻转</th>
      <th>拽砖专</th>
    </tr>
  </thead>
  <tbody>
    {% for t in items %}
    <tr>
      <td>{{ t.createdAt }}</td>
      <td class="usercell">
  <div class="userwrap">
    <img class="avatar" src="{{ t.author_avatar }}" alt="" onerror="this.style.display='none'">
    <div class="usernames">
      <div class="uname">@{{ t.author_userName }}</div>
      {% if t.author_name %}<div class="name small muted">{{ t.author_name }}</div>{% endif %}
    </div>
  </div>
</td>
      <td class="text">{{ t.text_highlight | safe }}</td>
      <td>{{ t.likeCount }}</td>
      <td>{{ t.retweetCount }}</td>
      <td>{{ t.replyCount }}</td>
      <td>{{ t.viewCount }}</td>
      <td><a href="{{ t.url }}" target="_blank">驻转</a></td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
